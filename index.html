<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Thronedis ‚Äì Collection Gate (Any Token)</title>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; background:#0b0f14; color:#e9f0f4; padding:32px; }
    h2 { margin: 0 0 8px }
    a { color:#67e8f9; font-weight:600; text-decoration:none }
    #secret { display:none; margin-top:24px }
    #locked { margin-top:16px }
    button { padding:10px 16px; border-radius:10px; border:0; cursor:pointer; background:#2563eb; color:white }
    .muted { opacity:.75 }
    code { background:#0f172a; padding:2px 6px; border-radius:6px }
    .card { background:#0f172a; border:1px solid #1f2937; border-radius:14px; padding:18px; margin-top:20px; }
  </style>
</head>
<body>
  <h2>üîê Thronedis ‚Äì Token Gated (Any token in collection)</h2>
  <div class="muted">Polygon (137) ¬∑ Collection: <code>0x76f4E59DBBF99D025B6F1014D33843AB138e4085</code></div>

  <div id="locked" class="card">
    <p>‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏ñ‡∏∑‡∏≠ NFT ‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≠‡∏•‡πÄ‡∏•‡πá‡∏Å‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ (‡∏ä‡∏¥‡πâ‡∏ô‡πÉ‡∏î‡∏Å‡πá‡πÑ‡∏î‡πâ) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏ü‡∏•‡πå</p>
    <button id="connect">üîë Connect Wallet & Verify</button>
    <p class="muted" style="margin-top:10px;">‡∏´‡∏≤‡∏Å‡∏Ñ‡∏≠‡∏•‡πÄ‡∏•‡πá‡∏Å‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô ERC‚Äë1155 ‡πÅ‡∏•‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏´‡∏•‡∏≤‡∏¢ tokenId ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡πÑ‡∏î‡πâ ‡πÉ‡∏´‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ <code>TOKEN_IDS</code> ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ</p>
  </div>

  <div id="secret" class="card">
    <h3>üéâ ‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÅ‡∏•‡πâ‡∏ß</h3>
    <p><a href="https://ipfs.io/ipfs/bafybeigsrytimlmv4dkz2px7ke4bwco4qj2kgxsdaeaxgmvkubiuexh5cu" target="_blank">üìÇ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏≤‡∏Å IPFS</a></p>
    <p class="muted">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: IPFS ‡πÄ‡∏õ‡πá‡∏ô public; ‡πÉ‡∏Ñ‡∏£‡πÑ‡∏î‡πâ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ô‡∏µ‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏î‡πâ ‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏™‡∏π‡∏á ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ó‡∏≥ one‚Äëtime link ‡∏ú‡πà‡∏≤‡∏ô backend</p>
  </div>

  <script>
    // ===== CONFIG =====
    const CONTRACT_ADDRESS = "0x76f4E59DBBF99D025B6F1014D33843AB138e4085";
    const NETWORK_HEX = "0x89"; // Polygon Mainnet
    // ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Å‡∏£‡∏ì‡∏µ ERC-1155: ‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏´‡∏•‡∏≤‡∏¢ tokenId ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏•‡πÄ‡∏•‡πá‡∏Å‡∏ä‡∏±‡∏ô‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡πÑ‡∏î‡πâ ‡πÉ‡∏´‡πâ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏ô‡∏•‡∏¥‡∏™‡∏ï‡πå‡∏ô‡∏µ‡πâ
    // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏¢‡πâ‡∏≤‡∏¢‡∏ï‡∏£‡∏ß‡∏à‡∏Å‡∏±‡∏ö backend
    const TOKEN_IDS = []; // ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ["0","1","2"]
    // ===================

    // ERC-165 interface ids
    const IID_ERC721  = "0x80ac58cd";
    const IID_ERC1155 = "0xd9b67a26";

    // Minimal ABIs
    const ABI_ERC165  = ["function supportsInterface(bytes4 interfaceId) view returns (bool)"];
    const ABI_ERC721  = ["function balanceOf(address owner) view returns (uint256)"];
    const ABI_ERC1155 = ["function balanceOf(address account, uint256 id) view returns (uint256)"];

    async function ensurePolygon() {
      const chainId = await window.ethereum.request({ method: "eth_chainId" });
      if (chainId !== NETWORK_HEX) {
        await window.ethereum.request({
          method: "wallet_switchEthereumChain",
          params: [{ chainId: NETWORK_HEX }]
        });
      }
    }

    async function detectStandard(provider) {
      const c165 = new ethers.Contract(CONTRACT_ADDRESS, ABI_ERC165, provider);
      try {
        const is721  = await c165.supportsInterface(IID_ERC721);
        const is1155 = await c165.supportsInterface(IID_ERC1155);
        if (is1155) return "ERC1155";
        if (is721)  return "ERC721";
      } catch {}
      return "ERC721"; // fallback
    }

    async function verifyAccess() {
      if (!window.ethereum) { alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á MetaMask"); return; }

      await ensurePolygon();
      const [account] = await window.ethereum.request({ method: "eth_requestAccounts" });

      const provider = new ethers.providers.Web3Provider(window.ethereum);
      const signer   = provider.getSigner();
      const standard = await detectStandard(provider);

      let hasAccess = false;

      if (standard === "ERC721") {
        const c = new ethers.Contract(CONTRACT_ADDRESS, ABI_ERC721, signer);
        const bal = await c.balanceOf(account);
        hasAccess = bal && ethers.BigNumber.from(bal).gt(0);
      } else {
        // ERC-1155: ‡πÄ‡∏ä‡πá‡∏Å‡∏´‡∏•‡∏≤‡∏¢ tokenId (‡∏ñ‡πâ‡∏≤ TOKEN_IDS ‡∏ß‡πà‡∏≤‡∏á ‡∏à‡∏∞‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏∏ ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ backend ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡∏≠‡∏•‡πÄ‡∏•‡πá‡∏Å‡∏ä‡∏±‡∏ô)
        if (!TOKEN_IDS.length) {
          alert("‡∏Ñ‡∏≠‡∏•‡πÄ‡∏•‡πá‡∏Å‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô ERC-1155: ‡πÇ‡∏õ‡∏£‡∏î‡∏Å‡∏≥‡∏´‡∏ô‡∏î TOKEN_IDS ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡πá‡∏Å‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡πâ‡∏≤‡∏¢‡∏ï‡∏£‡∏ß‡∏à‡∏Å‡∏±‡∏ö backend ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡πÑ‡∏≠‡∏î‡∏µ");
        } else {
          const c = new ethers.Contract(CONTRACT_ADDRESS, ABI_ERC1155, signer);
          for (const id of TOKEN_IDS) {
            const bal = await c.balanceOf(account, id);
            if (bal && ethers.BigNumber.from(bal).gt(0)) { hasAccess = true; break; }
          }
        }
      }

      document.getElementById("locked").style.display = hasAccess ? "none" : "block";
      document.getElementById("secret").style.display = hasAccess ? "block" : "none";
      if (!hasAccess) alert("‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏ñ‡∏∑‡∏≠‡∏Ñ‡∏£‡∏≠‡∏á)");
    }

    document.getElementById("connect").addEventListener("click", verifyAccess);
  </script>
</body>
</html>
